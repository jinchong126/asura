# 1、Asura
```shell
./asura ip port 参数解析
   -n：指定模拟客户端总数（缺省1w，最大6w）
   -p：每秒发送链接数（缺省1k）
   -t：持续时间
   -f: 指定发送内容，自动读取文件内容进行发送
   -w: 工作线程数，（缺省获取当前cpu核数）
   -s: 指定客户端ip地址
   -b: 指定客户端接口
   -d: 指定调试等级
   -h：帮助信息
```

# 2、测试
## 1) 每秒新增TPS：
```shell
ex：./asura 10.0.5.9 80 -n 50000 -p 10000 -w 4 -s 192.168.56.102 -t 10
```
说明：访问10.0.5.9:80 总共发起5w链接，每秒发起1w链接，启动4个工作线程，采用192.168.56.102为源ip，运行10s

## 2) 固定链接下，每秒新增TPS：
可以配合两个asura进行测试，一个用于保持链接，一个用于测试新增TPS
```shell
ex：./asura 10.0.5.9 80 -n 50000 -p 2000 -w 4 -s 192.168.56.102 -t 100（待链接全部成功后，执行下面命令）
ex：./asura 10.0.5.9 80 -n 10000 -p 10000 -w 4 -s 192.168.56.102 -t 100（在5w链接下的，新增TPS能力）
```

## 3) 最大连接数：
由于系统限制单IP只能模拟65535个客户端，要测试最大链接数需要多IP才能实现
通过上面找出设备每秒新增TPS，假设为4k，开启多个IP配置
```shell
ex：./asura 10.0.5.9 80 -n 60000 -p 4000 -w 4 -s 192.168.56.100 -t 100（待链接全部成功后，执行下面命令）
ex：./asura 10.0.5.9 80 -n 60000 -p 4000 -w 4 -s 192.168.56.101 -t 100（待链接全部成功后，执行下面命令）
ex：./asura 10.0.5.9 80 -n 60000 -p 4000 -w 4 -s 192.168.56.102 -t 100
```
如果上述2条执行成功，第三条成功1w，则最大连接数为6w+6w+1w=13w
# 3、未完成功能
   1）ssl  
   2）keepalive  
   3）链接过期资源回收  
   4）可以考虑连续发包  
   5）未实现主线程通知工作线程同时启动链接发送，但影响可忽略不计  
